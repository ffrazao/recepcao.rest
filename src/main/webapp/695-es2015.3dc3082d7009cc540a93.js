"use strict";(self.webpackChunkrecepcao_web=self.webpackChunkrecepcao_web||[]).push([[695],{695:function(t,e,i){i.r(e),i.d(e,{FormModule:function(){return it}});var n=i(8583),a=i(3679),o=i(3472),r=i(4957),l=i(8018),s=i(2865),u=i(8682),c=i(7716),p=i(2855),d=i(9227),f=i(1739),g=i(7850),v=i(4961);class m extends v.y{}var Z=i(1776),h=i(2340),_=i(1841),q=i(1685);let A=(()=>{class t{constructor(t,e){this._http=t,this.loginService=e,this.funcionalidade="visitante",this.filtro=new m}create(t){return t.id=null,this._http.post(`${h.N.REST_API_URL}/${this.funcionalidade}`,t,{headers:this.loginService.apiRequestHttpHeader})}restore(t){return this._http.get(`${h.N.REST_API_URL}/${this.funcionalidade}/${t}`,{headers:this.loginService.apiRequestHttpHeader})}update(t,e){return this._http.put(`${h.N.REST_API_URL}/${this.funcionalidade}/${t}`,e,{headers:this.loginService.apiRequestHttpHeader})}delete(t){return this._http.delete(`${h.N.REST_API_URL}/${this.funcionalidade}/${t}`,{headers:this.loginService.apiRequestHttpHeader})}prepararForm(t){return new Z.y(e=>{e.next(t),e.complete()})}prepararFiltro(t){return new Z.y(e=>{e.next(t),e.complete()})}filtrar(){let t="";if(this.filtro&&(t=(0,u.nZ)(this.filtro),t&&(t="?"+t)),this.funcionalidade)return this._http.get(`${h.N.REST_API_URL}/${this.funcionalidade}${t}`,{headers:this.loginService.apiRequestHttpHeader})}registrarSaida(t){return this._http.put(`${h.N.REST_API_URL}/${this.funcionalidade}/registrar-saida/${t}`,null,{headers:this.loginService.apiRequestHttpHeader})}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(_.eN),c.LFG(q.r))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var T=i(8203);function x(t,e){if(1&t&&c._UZ(0,"img",9),2&t){const t=c.oxw(2).$implicit;c.s9C("src",t.value.visitante.foto?"data:image/jpg;base64,"+t.value.visitante.foto:"",c.LSH)}}function b(t,e){if(1&t&&(c.ynx(0),c.TgZ(1,"td"),c._uU(2),c.qZA(),c.TgZ(3,"td"),c.YNc(4,x,1,1,"img",8),c.qZA(),c.TgZ(5,"td"),c._uU(6),c.qZA(),c.TgZ(7,"td"),c._uU(8),c.qZA(),c.TgZ(9,"td"),c._uU(10),c.qZA(),c.TgZ(11,"td"),c._uU(12),c.qZA(),c.TgZ(13,"td"),c._uU(14),c.ALo(15,"date"),c.qZA(),c.TgZ(16,"td"),c._uU(17),c.qZA(),c.BQk()),2&t){const t=c.oxw().$implicit;c.xp6(2),c.Oqu(null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj),c.xp6(2),c.Q6J("ngIf",null==t.value.visitante?null:t.value.visitante.foto),c.xp6(2),c.hij(" ",null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.nome,""),c.xp6(2),c.Oqu(t.value.telefone),c.xp6(2),c.Oqu(t.value.email),c.xp6(2),c.Oqu(null==t.value.entidadeRepresentante?null:t.value.entidadeRepresentante.nome),c.xp6(2),c.Oqu(c.xi3(15,8,t.value.saida,"EEEE, dd/MM/yyyy HH:mm")),c.xp6(3),c.Oqu(null==t.value.saidaUsuario?null:t.value.saidaUsuario.login)}}const U=function(){return{standalone:!0}};function C(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"div",15),c.TgZ(1,"input",16),c.NdJ("ngModelChange",function(e){return c.CHM(t),c.oxw(3).cpfPesq=e})("input",function(e){return c.CHM(t),c.oxw(3).formataCpf(e)}),c.qZA(),c.TgZ(2,"button",17),c.NdJ("click",function(e){c.CHM(t);const i=c.oxw(2).$implicit,n=c.oxw();return n.encontraVisitante(e,n.cpfPesq,i)}),c._UZ(3,"i",18),c.qZA(),c.qZA()}if(2&t){const t=c.oxw(3);c.xp6(1),c.Q6J("ngModel",t.cpfPesq)("ngModelOptions",c.DdM(3,U)),c.xp6(1),c.Q6J("disabled",!t.cpfPesq.trim().length)}}function J(t,e){if(1&t&&(c.ynx(0),c._uU(1),c.BQk()),2&t){const t=c.oxw(2).$implicit;c.xp6(1),c.hij(" ",null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj," ")}}function L(t,e){if(1&t&&c._UZ(0,"img",9),2&t){const t=c.oxw(2).$implicit;c.s9C("src",t.value.visitante.foto?"data:image/jpg;base64,"+t.value.visitante.foto:"",c.LSH)}}function N(t,e){1&t&&c._UZ(0,"input",19)}function S(t,e){1&t&&c._UZ(0,"input",20)}function R(t,e){if(1&t&&(c.TgZ(0,"option",23),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("ngValue",t),c.xp6(1),c.hij(" ",t.nome,"")}}function w(t,e){if(1&t&&(c.TgZ(0,"select",21),c.YNc(1,R,2,2,"option",22),c.qZA()),2&t){const t=c.oxw(3);c.Q6J("compareWith",t.idListComparar),c.xp6(1),c.Q6J("ngForOf",t.entidadeRepresentanteList)}}function y(t,e){if(1&t){const t=c.EpF();c.ynx(0),c._UZ(1,"input",24),c.TgZ(2,"button",25),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw().setSaida(e)}),c._uU(3,"Agora"),c.qZA(),c.TgZ(4,"button",26),c.NdJ("click",function(){c.CHM(t);const e=c.oxw(2).$implicit;return c.oxw().limparSaida(e)}),c._uU(5,"Limpar"),c.qZA(),c.BQk()}}function Q(t,e){if(1&t&&(c.ynx(0,10),c.TgZ(1,"td"),c.YNc(2,C,4,4,"div",11),c.YNc(3,J,2,1,"ng-container",5),c.qZA(),c.TgZ(4,"td"),c.YNc(5,L,1,1,"img",8),c.qZA(),c.TgZ(6,"td"),c._uU(7),c.qZA(),c.TgZ(8,"td"),c.YNc(9,N,1,0,"input",12),c.qZA(),c.TgZ(10,"td"),c.YNc(11,S,1,0,"input",13),c.qZA(),c.TgZ(12,"td"),c.YNc(13,w,2,2,"select",14),c.qZA(),c.TgZ(14,"td"),c.YNc(15,y,6,0,"ng-container",5),c.qZA(),c.TgZ(16,"td"),c._uU(17),c.qZA(),c.BQk()),2&t){const t=c.oxw().$implicit;c.Q6J("formGroup",t),c.xp6(2),c.Q6J("ngIf",!(null!=t&&null!=t.value&&null!=t.value.visitante&&null!=t.value.visitante.pessoa&&t.value.visitante.pessoa.cpfCnpj)),c.xp6(1),c.Q6J("ngIf",null==t||null==t.value||null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj),c.xp6(2),c.Q6J("ngIf",null==t.value.visitante?null:t.value.visitante.foto),c.xp6(2),c.hij(" ",null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.nome," "),c.xp6(2),c.Q6J("ngIf",null==t||null==t.value||null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj),c.xp6(2),c.Q6J("ngIf",null==t||null==t.value||null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj),c.xp6(2),c.Q6J("ngIf",null==t||null==t.value||null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj),c.xp6(2),c.Q6J("ngIf",null==t||null==t.value||null==t.value.visitante||null==t.value.visitante.pessoa?null:t.value.visitante.pessoa.cpfCnpj),c.xp6(2),c.Oqu(null==t.value.saidaUsuario?null:t.value.saidaUsuario.login)}}function F(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"button",0),c.NdJ("click",function(){c.CHM(t);const e=c.oxw().index;return c.oxw().excluir(e)}),c._uU(1,"Excluir"),c.qZA()}}function I(t,e){if(1&t){const t=c.EpF();c.TgZ(0,"tr"),c.TgZ(1,"td"),c._uU(2),c.qZA(),c.YNc(3,b,18,11,"ng-container",5),c.YNc(4,Q,18,10,"ng-container",6),c.TgZ(5,"td"),c.TgZ(6,"button",0),c.NdJ("click",function(){const e=c.CHM(t).$implicit;return e.editar=!e.editar}),c._uU(7),c.qZA(),c.YNc(8,F,2,0,"button",7),c.qZA(),c.qZA()}if(2&t){const t=e.$implicit,i=e.index;c.xp6(2),c.hij("",i+1,"."),c.xp6(1),c.Q6J("ngIf",!t.editar),c.xp6(1),c.Q6J("ngIf",t.editar),c.xp6(3),c.Oqu(t.editar?"Salvar":"Editar"),c.xp6(1),c.Q6J("ngIf",!t.editar)}}let $=(()=>{class t{constructor(t,e,i,n){this._visitanteRestService=t,this._entidadeRepresentanteRestService=e,this._formService=i,this._loginService=n,this.cpfPesq=""}ngOnInit(){this._entidadeRepresentanteRestService.filtrar().subscribe(t=>{this.entidadeRepresentanteList=t})}incluir(){let t=this._formService.criarVisitaVisitante(new g.h);t.editar=!0,this.dados.push(t)}excluir(t){this.dados.removeAt(t)}idListComparar(t,e){return(0,u.aH)(t,e)}encontraVisitante(t,e,i){!e||!e.trim().length||(this._visitanteRestService.filtro=this._visitanteRestService.filtro||new m,this._visitanteRestService.filtro.cpfCnpj=e,this._visitanteRestService.filtrar().subscribe(t=>{t&&0===t.length?alert("Registro n\xe3o localizado"):t&&1===t.length&&(i.get("visitante").patchValue(t[0]),i.get("telefone").patchValue(t[0].telefone?t[0].telefone:t[0].pessoa.contato1?t[0].pessoa.contato1:""),i.get("email").patchValue(t[0].email?t[0].email:t[0].pessoa.email?t[0].pessoa.email:""),i.get("entidadeRepresentante").patchValue(t[0].entidadeRepresentante),console.log(t)),this.cpfPesq=""}))}setSaida(t){let e=new Date,i=new Date(e.getTime()-6e4*e.getTimezoneOffset()).toISOString().substr(0,16);t.get("saida").patchValue(i),t.get("saidaUsuario").patchValue({login:this._loginService.dadosLogin.username})}limparSaida(t){t.get("saida").patchValue(null),t.get("saidaUsuario").patchValue(null)}formataCpf(t){let e=t.target.value;console.log("a");const i=e.replace(/[^0-9]/g,"");let n="***.***.***-**";for(let a=0;a<i.length;a++)n=n.replace("*",i.charAt(a));n.indexOf("*")>=0&&(n=n.substring(0,n.indexOf("*"))),t.target.value=n.trim()}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(A),c.Y36(T.v),c.Y36(p.o),c.Y36(q.r))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-visita-visitante"]],inputs:{dados:"dados"},decls:30,vars:1,consts:[[1,"btn","btn-primary",3,"click"],[1,"table-responsive"],[1,"table","table-hover","table-striped"],[1,"table-light"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"formGroup",4,"ngIf"],["class","btn btn-primary",3,"click",4,"ngIf"],["width","50","height","50","alt","Foto do visitante",3,"src",4,"ngIf"],["width","50","height","50","alt","Foto do visitante",3,"src"],[3,"formGroup"],["class","input-group mb-3",4,"ngIf"],["type","text","class","form-control","id","telefone","placeholder","(99) 9999-9999","formControlName","telefone",4,"ngIf"],["type","email","class","form-control","id","email","placeholder","usuario@dominio","formControlName","email",4,"ngIf"],["class","form-control","id","entidadeRepresentante","formControlName","entidadeRepresentante",3,"compareWith",4,"ngIf"],[1,"input-group","mb-3"],["type","text","id","cpfCnpj","placeholder","CPF","aria-label","CPF","aria-describedby","CPF do visitante",1,"form-control",3,"ngModel","ngModelOptions","ngModelChange","input"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","click"],[1,"fa","fa-search"],["type","text","id","telefone","placeholder","(99) 9999-9999","formControlName","telefone",1,"form-control"],["type","email","id","email","placeholder","usuario@dominio","formControlName","email",1,"form-control"],["id","entidadeRepresentante","formControlName","entidadeRepresentante",1,"form-control",3,"compareWith"],[3,"ngValue",4,"ngFor","ngForOf"],[3,"ngValue"],["type","datetime-local","id","saida","placeholder","Sa\xedda","formControlName","saida",1,"form-control"],[1,"btn","btn-secondary","btn-sm",3,"click"],[1,"btn","btn-light","btn-sm",3,"click"]],template:function(t,e){1&t&&(c.TgZ(0,"p"),c._uU(1,"Rela\xe7\xe3o de Visitantes"),c.qZA(),c.TgZ(2,"button",0),c.NdJ("click",function(){return e.incluir()}),c._uU(3,"Incluir"),c.qZA(),c.TgZ(4,"div",1),c.TgZ(5,"table",2),c.TgZ(6,"thead",3),c.TgZ(7,"tr"),c.TgZ(8,"th"),c._uU(9,"#"),c.qZA(),c.TgZ(10,"th"),c._uU(11,"CPF"),c.qZA(),c.TgZ(12,"th"),c._uU(13,"Foto"),c.qZA(),c.TgZ(14,"th"),c._uU(15,"Visitante"),c.qZA(),c.TgZ(16,"th"),c._uU(17,"Telefone"),c.qZA(),c.TgZ(18,"th"),c._uU(19,"E-mail"),c.qZA(),c.TgZ(20,"th"),c._uU(21,"Entidade Representante"),c.qZA(),c.TgZ(22,"th"),c._uU(23,"Sa\xedda"),c.qZA(),c.TgZ(24,"th"),c._uU(25,"Sa\xedda Registrada Por"),c.qZA(),c.TgZ(26,"th"),c._uU(27,"A\xe7\xe3o"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(28,"tbody"),c.YNc(29,I,9,5,"tr",4),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(29),c.Q6J("ngForOf",e.dados.controls))},directives:[n.sg,n.O5,a.JL,a.sg,a.Fj,a.JJ,a.On,a.u,a.EJ,a.YN,a.Kr],pipes:[n.uU],styles:[""]}),t})();var Y=i(2883);function k(t,e){if(1&t&&(c.TgZ(0,"option",19),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("ngValue",t),c.xp6(1),c.hij(" ",t.nome," ")}}function H(t,e){if(1&t&&(c.TgZ(0,"option",19),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("ngValue",t),c.xp6(1),c.hij(" ",t.nome," ")}}function O(t,e){if(1&t&&(c.TgZ(0,"option",19),c._uU(1),c.qZA()),2&t){const t=e.$implicit;c.Q6J("ngValue",t),c.xp6(1),c.hij(" ",t.pessoa.nome," ")}}const j=function(){return["../novo"]},V=function(){return["./filtro"]},E=function(){return["S"]},M=function(){return["N"]},P=function(){return["../"]};let z=(()=>{class t{constructor(t,e,i,n,a){this._form=t,this._activatedRoute=e,this._router=i,this._rest=n,this._mensagem=a}ngOnInit(){this.formulario=this._form.criar(this._activatedRoute.snapshot.data[0]),this.localList=this._activatedRoute.snapshot.data[1],this.usuarioList=this._activatedRoute.snapshot.data[2],this.funcionarioList=this._activatedRoute.snapshot.data[3]}idListComparar(t,e){return(0,u.aH)(t,e)}filtraLocal(t,e){return t.portaria===e[0]}salvar(){let t=this.formulario.value;t.id?this._rest.update(t.id,t).subscribe(e=>{this._router.navigate([`visita/${t.id}`],{queryParamsHandling:"merge"}),this._mensagem.sucesso("Dados Salvos","Sucesso")}):this._rest.create(t).subscribe(t=>{this._router.navigate([`visita/${t}`],{queryParamsHandling:"merge"}),this._mensagem.sucesso("Dados Salvos","Sucesso")})}}return t.\u0275fac=function(e){return new(e||t)(c.Y36(p.o),c.Y36(o.gz),c.Y36(o.F0),c.Y36(d.v),c.Y36(f.w))},t.\u0275cmp=c.Xpm({type:t,selectors:[["app-form"]],decls:46,vars:26,consts:[["queryParamsHandling","merge",1,"btn","btn-primary",3,"routerLink"],[1,"container"],[3,"formGroup"],[1,"form-group"],["for","entradaLocal"],["id","entradaLocal","formControlName","entradaLocal",1,"form-control",3,"compareWith"],[3,"ngValue",4,"ngFor","ngForOf"],["for","entrada"],["type","datetime-local","id","entrada","placeholder","dd/mm/aaaa hh:mm","formControlName","entrada",1,"form-control"],["for","destinoLocal"],["id","destinoLocal","formControlName","destinoLocal",1,"form-control",3,"compareWith"],["for","motivo"],["id","motivo","rows","3","formControlName","motivo",1,"form-control"],["for","exampleFormControlInput1"],["formArrayName","visitaVisitanteList",3,"dados"],["for","autorizador"],["id","autorizador","formControlName","autorizador",1,"form-control",3,"compareWith"],[1,"form-control"],[1,"btn","btn-primary",3,"disabled","click"],[3,"ngValue"]],template:function(t,e){1&t&&(c.TgZ(0,"p"),c._uU(1,"Formul\xe1rio Visita"),c.qZA(),c.TgZ(2,"button",0),c._uU(3,"Incluir"),c.qZA(),c.TgZ(4,"button",0),c._uU(5,"Filtrar"),c.qZA(),c.TgZ(6,"div",1),c.TgZ(7,"form",2),c.TgZ(8,"div",3),c.TgZ(9,"label",4),c._uU(10,"Entrada"),c.qZA(),c.TgZ(11,"select",5),c.YNc(12,k,2,2,"option",6),c.ALo(13,"callback"),c.qZA(),c.qZA(),c.TgZ(14,"div",3),c.TgZ(15,"label",7),c._uU(16,"Hora Entrada"),c.qZA(),c._UZ(17,"input",8),c.qZA(),c.TgZ(18,"div",3),c.TgZ(19,"label",9),c._uU(20,"Destino"),c.qZA(),c.TgZ(21,"select",10),c.YNc(22,H,2,2,"option",6),c.ALo(23,"callback"),c.qZA(),c.qZA(),c.TgZ(24,"div",3),c.TgZ(25,"label",11),c._uU(26,"Motivo"),c.qZA(),c._UZ(27,"textarea",12),c.qZA(),c.TgZ(28,"div",3),c.TgZ(29,"label",13),c._uU(30,"Visitantes"),c.qZA(),c._UZ(31,"app-visita-visitante",14),c.qZA(),c.TgZ(32,"div",3),c.TgZ(33,"label",15),c._uU(34,"Autorizador"),c.qZA(),c.TgZ(35,"select",16),c.YNc(36,O,2,2,"option",6),c.qZA(),c.qZA(),c.TgZ(37,"div",3),c.TgZ(38,"label",13),c._uU(39,"Incluido por"),c.qZA(),c.TgZ(40,"div",17),c._uU(41),c.qZA(),c.qZA(),c.TgZ(42,"button",18),c.NdJ("click",function(){return e.salvar()}),c._uU(43,"Salvar"),c.qZA(),c.TgZ(44,"button",0),c._uU(45,"Cancelar"),c.qZA(),c.qZA(),c.qZA()),2&t&&(c.xp6(2),c.Q6J("routerLink",c.DdM(21,j)),c.xp6(2),c.Q6J("routerLink",c.DdM(22,V)),c.xp6(3),c.Q6J("formGroup",e.formulario),c.xp6(4),c.Q6J("compareWith",e.idListComparar),c.xp6(1),c.Q6J("ngForOf",c.Dn7(13,13,e.localList,e.filtraLocal,c.DdM(23,E))),c.xp6(9),c.Q6J("compareWith",e.idListComparar),c.xp6(1),c.Q6J("ngForOf",c.Dn7(23,17,e.localList,e.filtraLocal,c.DdM(24,M))),c.xp6(9),c.Q6J("dados",e.formulario.controls.visitaVisitanteList),c.xp6(4),c.Q6J("compareWith",e.idListComparar),c.xp6(1),c.Q6J("ngForOf",e.funcionarioList),c.xp6(5),c.Oqu(e.formulario.value.incluidoPor.login),c.xp6(1),c.Q6J("disabled",e.formulario.invalid),c.xp6(2),c.Q6J("routerLink",c.DdM(25,P)))},directives:[o.rH,a._Y,a.JL,a.sg,a.EJ,a.JJ,a.u,n.sg,a.Fj,$,a.CE,a.YN,a.Kr],pipes:[Y.A],styles:[""]}),t})(),D=(()=>{class t{constructor(t){this._servico=t}resolve(t,e){let i=t.params.id;return"novo"===i.toLowerCase()?this._servico.prepararForm(null):this._servico.restore(i)}}return t.\u0275fac=function(e){return new(e||t)(c.LFG(d.v))},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const B=[{path:"",component:z,resolve:[D,r.i,l.i,s.i]}];let W=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.Bz.forChild(B)],o.Bz]}),t})();const G=[];let X=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({imports:[[o.Bz.forChild(G)],o.Bz]}),t})(),K=(()=>{class t{constructor(){}resolve(t,e){return null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=c.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),tt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({providers:[K],imports:[[n.ez,a.u5,a.UX,X]]}),t})();var et=i(302);let it=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=c.oAB({type:t}),t.\u0275inj=c.cJS({providers:[D],imports:[[n.ez,a.u5,a.UX,W,tt,et.d]]}),t})()}}]);